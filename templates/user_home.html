{% extends 'base.html' %}

{% block title %}
Личный кабинет
{% endblock %}

{% block body %}

<div class="text-center">
   <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
        <button class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#tasks" type="button" role="tab" aria-controls="tasks" aria-selected="true">Мои задачи</button>
        </li>
        <li class="nav-item" role="presentation">
        <button class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">Профиль</button>
        </li>
    </ul>

 <div class="tab-content" id="myTabContent">

    <div class="tab-pane fade show active" id="tasks" role="tabpanel" aria-labelledby="home-tab">


        <table class="table table-striped table-hover table-bordered" id="myTable">
    <thead>
            <th scope="col" class="td-10px">ID</th>
            <th scope="col" class="td-90px">Действия</th>
            <th scope="col" class="td-90px">Инициатор</th>
            <th scope="col" class="td-90px">Направление</th>
            <th scope="col" class="td-90px">Тип задачи</th>
            <th scope="col">Название</th>
            <th scope="col">Задание</th>
            <th scope="col" class="td-90px">Исполнитель</th>
            <th scope="col" class="td-90px">Приоритет</th>
            <th scope="col" class="td-time">Дата создания</th>
            <th scope="col" class="td-time">Срок исполнения</th>
            <th scope="col" class="td-90px">Статус</th>
    </thead>
    <tbody>
        {% for el in tasks %}
            <tr>
                <td scope="row">{{ el.id }}</td>
                <td>
                    <a href="/tasks/{{ el.id }}" class="btn btn-primary">Детальнее</a>
                </td>
                <td>{{ el.user.fio }}</td>
                <td>{{ el.direction.name }}</td>
                <td>{{ el.type.name }}</td>
                <td>{{ el.title }}</td>
                <td>
                    <div class="tasks-discription">{{ el.description|safe }}</div>
                </td>
                <td>{{ el.to_user.fio }}</td>
                <td {% if el.urgency.name=="Низкий" %}
                    style="background-color:MediumSeaGreen;"
                    {% elif el.urgency.name=="Средний" %}
                    style="background-color:Orange;"
                    {% elif el.urgency.name=="Высокий" %}
                    style="background-color:Tomato;"
                    {% endif%}>
                    {{ el.urgency.name }}
                </td>
                <td>{{ el.date_start.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ el.date_finish.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ el.status.name }}</td>
            </tr>
        {% endfor %}


    </tbody>
</table>



    </div>
    <div class="tab-pane fade show" id="profile" role="tabpanel" aria-labelledby="home-tab">
         <form class="authorization-form" action="/user/{{ user.id }}/user_update" method="post">
            <h1 class="h3 mb-3 fw-normal">Изменение пользователя</h1>
                {% with messages = get_flashed_messages() %}
              {% if messages %}
                <div class="h6 flashes">
                {% for message in messages %}
                  {{ message }}
                {% endfor %}
                </div>
              {% endif %}
            {% endwith %}
              <div class="form-floating">
              <input type="text" class="form-control" id="id" name="id" placeholder="ID" disabled value="{{ user.id }}">
              <label for="login">{{ user.id }}</label>
            </div>
            <div class="form-floating">
              <input type="text" class="form-control" id="login" name="login" placeholder="Логин" disabled value="{{ user.login }}">
              <label for="login">{{ user.login }}</label>
            </div>
              <div class="form-floating">
              <input type="text" class="form-control" id="fio" name="fio" placeholder="ФИО" value="{{ user.fio }}">
              <label for="fio">{{ user.fio }}</label>
            </div>
            <div class="form-floating">
              <input type="password" class="form-control" id="password"  name="password" placeholder="Пароль">
              <label for="password">Пароль</label>
            </div>
              <div class="form-floating">
              <input type="password" class="form-control" id="password2"  name="password2" placeholder="Повторите пароль">
              <label for="password2">Повторите пароль</label>
            </div>

            <button class="w-100 btn btn-lg btn-primary button-auth" type="submit">Отправить изменения</button>
            <p class="mt-5 mb-3 text-muted">© 2021–2021</p>
          </form>
    </div>



 </div>





</div>
{% endblock %}